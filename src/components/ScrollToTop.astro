<button class="scrollTopBtn" type="button" aria-label="Torna su" data-scroll-top data-visible="false">
	<svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
		<path d="M12 5l-7 7m7-7l7 7M12 5v14" stroke="rgb(var(--ink))" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
	</svg>
	<span class="sr-only">Torna su</span>
</button>

<style>
	.scrollTopBtn {
		position: fixed;
		bottom: var(--space-6);
		right: var(--space-6);
		width: 48px;
		height: 48px;
		border-radius: 9999px;
		background: rgb(var(--accent));
		border: none;
		color: rgb(var(--paper));
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		opacity: 0;
		transform: translateY(20px);
		pointer-events: none;
		transition: opacity 300ms ease, transform 300ms ease, box-shadow 200ms ease;
		z-index: var(--z-sticky);
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
	}

	.scrollTopBtn[data-visible="true"] {
		opacity: 1;
		transform: translateY(0);
		pointer-events: auto;
	}

	.scrollTopBtn:hover {
		background: rgb(var(--accent) / 0.9);
		box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
		transform: translateY(-2px);
	}

	.scrollTopBtn:active {
		transform: translateY(0);
	}

	.scrollTopBtn:focus-visible {
		outline: 2px solid rgb(var(--accent));
		outline-offset: 3px;
	}

	@media (prefers-reduced-motion: reduce) {
		.scrollTopBtn {
			transition: opacity 150ms ease;
		}

		.scrollTopBtn:hover {
			transform: translateY(0);
		}
	}

	.sr-only {
		position: absolute;
		width: 1px;
		height: 1px;
		padding: 0;
		margin: -1px;
		overflow: hidden;
		clip: rect(0, 0, 0, 0);
		white-space: nowrap;
		border-width: 0;
	}
</style>

<script>
	(function () {
		const btn = document.querySelector('[data-scroll-top]');
		if (!btn) return;

		const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
		let ticking = false;

		function isMenuOpen() {
			return document.documentElement.dataset.menuOpen === 'true';
		}

		function update() {
			const y = window.scrollY || 0;
			const shouldShow = y > 500 && !isMenuOpen();
			btn.setAttribute('data-visible', shouldShow ? 'true' : 'false');
			ticking = false;
		}

		function onScroll() {
			if (!ticking) {
				window.requestAnimationFrame(update);
				ticking = true;
			}
		}

		btn.addEventListener('click', () => {
			window.scrollTo({ top: 0, behavior: prefersReducedMotion ? 'auto' : 'smooth' });
		});

		window.addEventListener('scroll', onScroll, { passive: true });
		update();
	})();
</script>



